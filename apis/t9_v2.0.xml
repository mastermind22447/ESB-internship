<?xml version="1.0" encoding="UTF-8"?>
<api xmlns="http://ws.apache.org/ns/synapse" name="Task9API" context="/services/training/v1.0/task/9">
  <resource methods="GET" uri-template="/{categoryId}">
    <inSequence>
      <!-- Extract categoryId from URL -->
      <property name="categoryId" expression="get-property('uri.var.categoryId')" scope="default" type="STRING"/>
      <!-- Force the message type to JSON to avoid XML parsing (DOCTYPE error) -->
      <property name="messageType" value="application/json" scope="axis2"/>
      <property name="ContentType" value="application/json" scope="axis2"/>
      <!-- Call the external category service -->
      <call>
        <endpoint>
          <http method="GET" uri-template="http://localhost:3000/rbt/v1.0/category/{uri.var.categoryId}"/>
        </endpoint>
      </call>
      <!-- Log the response -->
      <log level="full"/>
      <!-- Respond back to the client -->
      <respond/>
    </inSequence>
    <outSequence/>
    <faultSequence>
      <log level="full"/>
      <property name="HTTP_SC" value="500" scope="axis2"/>
      <respond/>
    </faultSequence>
  </resource>
</api>

